@model PhoneStore.Models.Product
@{
	ViewData["Title"] = "Cập nhật sản phẩm";
}

<div id="page-wrapper">
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-12">
				<h1 class="page-header">
					<i class="fa fa-plus-circle"></i> @ViewData["Title"]
				</h1>
			</div>
		</div>

@if (ViewBag.SuccessMessage != null)
	{
		<div class="alert alert-success">
			@ViewBag.SuccessMessage
		</div>
	}
	@if (ViewBag.ErrorMessage != null)
	{
		<div class="alert alert-danger">
			@ViewBag.ErrorMessage
		</div>
	}
	@if (TempData["SuccessMessage"] != null)
		{
			<div class="alert alert-success">
				@TempData["SuccessMessage"]
			</div>
		}
		@if (TempData["ErrorMessage"] != null)
		{
			<div class="alert alert-danger">
				@TempData["ErrorMessage"]
			</div>
		}

		<form asp-action="EditProduct" asp-controller="Product" asp-area="Admin" method="post" enctype="multipart/form-data">
			<input type="hidden" asp-for="product_id" />
			<div class="row">
				<div class="col-lg-8">
					<div class="panel panel-default">
						<div class="panel-heading">
							<i class="fa fa-info-circle"></i> Thông tin sản phẩm
						</div>
						<div class="panel-body">
							<div class="form-group">
								<label><i class="fa fa-tag"></i> Tên sản phẩm <span class="text-danger">*</span></label>
								<input asp-for="product_name" class="form-control" placeholder="Nhập tên sản phẩm..." required />
								<span asp-validation-for="product_name" class="text-danger"></span>
							</div>

							<div class="row">
								<div class="col-lg-6">
									<div class="form-group">
										<label><i class="fa fa-folder"></i> Danh mục <span class="text-danger">*</span></label>
										<select asp-for="category_id" class="form-control" required>
											<option value="">-- Chọn danh mục --</option>
											@if (ViewBag.Categories != null)
											{
												@foreach (var category in ViewBag.Categories)
												{
													<option value="@category.category_id">@category.category_name</option>
												}
											}
										</select>
										<span asp-validation-for="category_id" class="text-danger"></span>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label><i class="fa fa-building"></i> Thương hiệu</label>
										<input asp-for="brand" class="form-control" placeholder="VD: Apple, Samsung..." />
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-lg-6">
									<div class="form-group">
										<label><i class="fa fa-dollar"></i> Giá bán <span class="text-danger">*</span></label>
										<input asp-for="price" class="form-control" type="number" step="1000" placeholder="0" required />
										<span asp-validation-for="price" class="text-danger"></span>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label><i class="fa fa-percent"></i> Giảm giá (%)</label>
										<input asp-for="discount_percent" class="form-control" type="number" min="0" max="100" placeholder="0" />
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-lg-6">
									<div class="form-group">
										<label><i class="fa fa-cubes"></i> Số lượng tồn kho <span class="text-danger">*</span></label>
										<input asp-for="stock_quantity" class="form-control" type="number" placeholder="0" required />
										<span asp-validation-for="stock_quantity" class="text-danger"></span>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label><i class="fa fa-chart-line"></i> Đã bán</label>
										<input asp-for="sold_count" class="form-control" type="number" placeholder="0" value="0" />
									</div>
								</div>
							</div>

							<div class="form-group">
								<label><i class="fa fa-align-left"></i> Mô tả sản phẩm</label>
								<textarea asp-for="description" class="form-control" rows="5" placeholder="Nhập mô tả chi tiết về sản phẩm..."></textarea>
							</div>

							<div class="row">
								<div class="col-lg-3">
									<div class="form-group">
										<label>RAM</label>
										<input asp-for="ram" class="form-control" placeholder="VD: 8GB" />
									</div>
								</div>
								<div class="col-lg-3">
									<div class="form-group">
										<label>Bộ nhớ</label>
										<input asp-for="storage" class="form-control" placeholder="VD: 256GB" />
									</div>
								</div>
								<div class="col-lg-3">
									<div class="form-group">
										<label>Màu sắc</label>
										<input asp-for="color" class="form-control" placeholder="VD: Đen" />
									</div>
								</div>
								<div class="col-lg-3">
									<div class="form-group">
										<label>Hệ điều hành</label>
										<input asp-for="os" class="form-control" placeholder="VD: iOS 17" />
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-lg-6">
									<div class="form-group">
										<label>Kích thước màn hình</label>
										<input asp-for="screen_size" class="form-control" placeholder="VD: 6.1 inch" />
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label>Trạng thái</label>
										<select asp-for="status" class="form-control">
											<option value="1">Hiển thị</option>
											<option value="0">Ẩn</option>
										</select>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="col-lg-4">
					<div class="panel panel-primary">
						<div class="panel-heading">
							<i class="fa fa-image"></i> Hình ảnh sản phẩm
						</div>
						<div class="panel-body">
							<div class="form-group">
								<label><i class="fa fa-camera"></i> Hình ảnh chính</label>
								<div class="text-center" style="margin-bottom: 10px;">
									<img id="preview-image" src="~/img/no-image.png" alt="Preview" class="img-thumbnail" style="max-width: 100%; max-height: 250px;">
								</div>
								<input type="file" name="imageFile" id="image-input" class="form-control" accept="image/*" onchange="previewImage(this)" />
								<p class="help-block"><small><i class="fa fa-info-circle"></i> Định dạng: JPG, PNG, GIF (Tối đa 5MB)</small></p>
							</div>
						</div>
					</div>

					<div class="panel panel-default">
						<div class="panel-body">
							<button type="submit" class="btn btn-success btn-block btn-lg">
								<i class="fa fa-save"></i> Lưu sản phẩm
							</button>
							<a asp-area="Admin" asp-controller="Product" asp-action="Index" class="btn btn-default btn-block">
								<i class="fa fa-arrow-left"></i> Quay lại
							</a>
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>
</div>

<style>
	#page-wrapper {
		margin-left: 220px;
		padding: 20px;
		min-height: 100vh;
		background: #f8f9fa;
	}

	.panel {
		background: white;
		border-radius: 8px;
		box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		margin-bottom: 20px;
	}

	.panel-heading {
		background: #f5f5f5;
		padding: 15px;
		border-bottom: 1px solid #ddd;
		font-weight: 600;
		border-radius: 8px 8px 0 0;
	}

	.panel-primary .panel-heading {
		background: #337ab7;
		color: white;
	}

	.panel-body {
		padding: 20px;
	}

	.form-group {
		margin-bottom: 15px;
	}

	.form-group label {
		font-weight: 600;
		margin-bottom: 5px;
		display: block;
	}

	.form-control {
		width: 100%;
		padding: 8px 12px;
		border: 1px solid #ddd;
		border-radius: 4px;
	}

	.form-control:focus {
		border-color: #337ab7;
		outline: none;
		box-shadow: 0 0 0 0.2rem rgba(51, 122, 183, 0.25);
	}

	.btn {
		padding: 10px 20px;
		border: none;
		border-radius: 4px;
		cursor: pointer;
		font-weight: 600;
		transition: all 0.3s;
	}

	.btn-success {
		background: #28a745;
		color: white;
	}

	.btn-success:hover {
		background: #218838;
	}

	.btn-default {
		background: #6c757d;
		color: white;
		text-decoration: none;
		display: inline-block;
		text-align: center;
	}

	.btn-default:hover {
		background: #5a6268;
		color: white;
	}

	.btn-block {
		width: 100%;
		display: block;
	}

	.btn-lg {
		padding: 12px 24px;
		font-size: 16px;
	}

	.alert {
		padding: 15px;
		border-radius: 4px;
		margin-bottom: 20px;
	}

	.alert-success {
		background: #d4edda;
		border: 1px solid #c3e6cb;
		color: #155724;
	}

	.alert-danger {
		background: #f8d7da;
		border: 1px solid #f5c6cb;
		color: #721c24;
	}

	.text-danger {
		color: #dc3545;
	}

	.help-block {
		margin-top: 5px;
		color: #6c757d;
	}
</style>

@section Scripts {
	<script>
		function previewImage(input) {
			if (input.files && input.files[0]) {
				var reader = new FileReader();
				reader.onload = function(e) {
					document.getElementById('preview-image').src = e.target.result;
				}
				reader.readAsDataURL(input.files[0]);
			}
		}
	</script>
}
